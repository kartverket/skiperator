apiVersion: v1
kind: ServiceAccount
metadata:
  name: minimal-job
---
apiVersion: v1
kind: Service
metadata:
  name: minimal-job
spec:
  selector:
    app: minimal-job
  ports:
    - name: http
      port: 8080
      targetPort: 8080
      protocol: TCP
      appProtocol: http
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: minimal-job
spec:
  podSelector:
    matchLabels:
      app: minimal-job
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: minimal-job
spec:
  selector:
    matchLabels:
      app: minimal-job
  mtls:
    mode: STRICT
